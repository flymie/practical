<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>file</title>
</head>
<body>
  <input type="file" onchange="onFile(event)" />
  <div class="contents"></div>
<script>
  const content = document.getElementsByTagName("input");
  const contentBox = document.getElementsByClassName("contents")[0]
  let files,
    type,
    urlData,
    html
  function onFile(e) {
    console.log(e);
    files = e.target.files
    console.log(files, files[0].type, 'files');
    //FileReader读取文件内容
    var reader = new FileReader();
    if (/image/.test(files[0].type)) {
      reader.readAsDataURL(files[0])
      type = 'image'
    } else {

      reader.readAsText(files[0]);
      type = 'text'
    }
    reader.onerror = function () {
      console.log('error');
    }
    reader.onload = function (e) {
      // urlData就是对应的文件内容
      urlData = reader.result;

      switch (type) {
        case 'image':
          html = `<img src = '${urlData}'  / >`
          break;
        case 'text':
          html = `<p>${urlData}</p>`
      }
      contentBox.innerHTML = html

    };
  }
</script>
<script>
  // 统计doc、pdf文件的文字字数
  function countWords(file) {
    const reader = new FileReader();
    reader.readAsArrayBuffer(file);
    reader.onload = function() {
      const result = this.result;
      if (file.type === 'application/pdf') {
        // 统计pdf文件文字字数
        const loadingTask = pdfjsLib.getDocument({ data: result });
        loadingTask.promise.then(function(pdf) {
          let count = 0;
          for (let i = 1; i <= pdf.numPages; i++) {
            pdf.getPage(i).then(function(page) {
              page.getTextContent().then(function(textContent) {
                count += textContent.items.length;
                if (i === pdf.numPages) {
                  console.log(`PDF文件文字字数：${count}`);
                }
              });
            });
          }
        });
      } else if (file.type === 'application/msword') {
        // 统计doc文件文字字数
        const doc = new ActiveXObject('Word.Application');
        doc.Visible = false;
        const docFile = doc.Documents.OpenFromByteArray(result);
        const count = docFile.Content.ComputeStatistics(2);
        console.log(`DOC文件文字字数：${count}`);
        docFile.Close(false);
        doc.Quit(false);
      } else {
        console.log('不支持的文件类型');
      }
    }
  }
</script>
</body>
</html>
